{
  "type": "bundle",
  "id": "bundle--atomic-lab-0001",
  "objects": [
    {
      "type": "intrusion-set",
      "id": "intrusion-set--atomic-sim-0001",
      "name": "Atomic Simulation"
    },
    {
      "type": "campaign",
      "id": "campaign--windows-run-0001",
      "name": "Windows Run — Host 172.16.20.42"
    },
    {
      "type": "campaign",
      "id": "campaign--linux-run-0001",
      "name": "Linux Run — Host 172.16.20.50"
    },
    {
      "type": "report",
      "id": "report--atomic-lab-0001",
      "name": "Atomic Lab Runs (Windows & Linux)",
      "published": "2025-01-01T00:00:00Z",
      "object_refs": [
        "intrusion-set--atomic-sim-0001",
        "campaign--windows-run-0001",
        "campaign--linux-run-0001"
      ]
    },

    /* ---------------- ATT&CK Techniques (Windows Host) ---------------- */
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1059-001",
      "name": "Command and Scripting Interpreter: PowerShell",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1059.001", "url": "https://attack.mitre.org/techniques/T1059/001/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1047",
      "name": "Windows Management Instrumentation",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1047", "url": "https://attack.mitre.org/techniques/T1047/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1053-005",
      "name": "Scheduled Task/Job: Scheduled Task",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1053.005", "url": "https://attack.mitre.org/techniques/T1053/005/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1569-002",
      "name": "System Services: Service Execution",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1569.002", "url": "https://attack.mitre.org/techniques/T1569/002/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1547-001",
      "name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1547.001", "url": "https://attack.mitre.org/techniques/T1547/001/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1112",
      "name": "Modify Registry",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1112", "url": "https://attack.mitre.org/techniques/T1112/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1218-005",
      "name": "Signed Binary Proxy Execution: Mshta",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1218.005", "url": "https://attack.mitre.org/techniques/T1218/005/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1218-011",
      "name": "Signed Binary Proxy Execution: Rundll32",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1218.011", "url": "https://attack.mitre.org/techniques/T1218/011/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1105",
      "name": "Ingress Tool Transfer",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1105", "url": "https://attack.mitre.org/techniques/T1105/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1082",
      "name": "System Information Discovery",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1082", "url": "https://attack.mitre.org/techniques/T1082/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1033",
      "name": "Account Discovery",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1033", "url": "https://attack.mitre.org/techniques/T1033/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1016",
      "name": "System Network Configuration Discovery",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1016", "url": "https://attack.mitre.org/techniques/T1016/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1036",
      "name": "Masquerading",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1036", "url": "https://attack.mitre.org/techniques/T1036/" }
      ]
    },

    /* ---------------- ATT&CK Techniques (Linux Host) ---------------- */
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1059-004",
      "name": "Command and Scripting Interpreter: Bash",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1059.004", "url": "https://attack.mitre.org/techniques/T1059/004/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1053-003",
      "name": "Scheduled Task/Job: Cron",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1053.003", "url": "https://attack.mitre.org/techniques/T1053/003/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1069-001",
      "name": "Permission Groups Discovery: Local Groups",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1069.001", "url": "https://attack.mitre.org/techniques/T1069/001/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1057",
      "name": "Process Discovery",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1057", "url": "https://attack.mitre.org/techniques/T1057/" }
      ]
    },
    {
      "type": "attack-pattern",
      "id": "attack-pattern--t1083",
      "name": "File and Directory Discovery",
      "external_references": [
        { "source_name": "mitre-attack", "external_id": "T1083", "url": "https://attack.mitre.org/techniques/T1083/" }
      ]
    },

    /* --------------- Relationships: campaigns use techniques --------------- */
    /* Windows campaign uses … */
    { "type": "relationship", "id": "relationship--win-1", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1059-001" },
    { "type": "relationship", "id": "relationship--win-2", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1047" },
    { "type": "relationship", "id": "relationship--win-3", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1053-005" },
    { "type": "relationship", "id": "relationship--win-4", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1569-002" },
    { "type": "relationship", "id": "relationship--win-5", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1547-001" },
    { "type": "relationship", "id": "relationship--win-6", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1112" },
    { "type": "relationship", "id": "relationship--win-7", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1218-005" },
    { "type": "relationship", "id": "relationship--win-8", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1218-011" },
    { "type": "relationship", "id": "relationship--win-9", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1105" },
    { "type": "relationship", "id": "relationship--win-10", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1082" },
    { "type": "relationship", "id": "relationship--win-11", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1033" },
    { "type": "relationship", "id": "relationship--win-12", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1016" },
    { "type": "relationship", "id": "relationship--win-13", "relationship_type": "uses", "source_ref": "campaign--windows-run-0001", "target_ref": "attack-pattern--t1036" },

    /* Linux campaign uses … */
    { "type": "relationship", "id": "relationship--lin-1", "relationship_type": "uses", "source_ref": "campaign--linux-run-0001", "target_ref": "attack-pattern--t1059-004" },
    { "type": "relationship", "id": "relationship--lin-2", "relationship_type": "uses", "source_ref": "campaign--linux-run-0001", "target_ref": "attack-pattern--t1053-003" },
    { "type": "relationship", "id": "relationship--lin-3", "relationship_type": "uses", "source_ref": "campaign--linux-run-0001", "target_ref": "attack-pattern--t1105" },
    { "type": "relationship", "id": "relationship--lin-4", "relationship_type": "uses", "source_ref": "campaign--linux-run-0001", "target_ref": "attack-pattern--t1082" },
    { "type": "relationship", "id": "relationship--lin-5", "relationship_type": "uses", "source_ref": "campaign--linux-run-0001", "target_ref": "attack-pattern--t1016" },
    { "type": "relationship", "id": "relationship--lin-6", "relationship_type": "uses", "source_ref": "campaign--linux-run-0001", "target_ref": "attack-pattern--t1069-001" },
    { "type": "relationship", "id": "relationship--lin-7", "relationship_type": "uses", "source_ref": "campaign--linux-run-0001", "target_ref": "attack-pattern--t1057" },
    { "type": "relationship", "id": "relationship--lin-8", "relationship_type": "uses", "source_ref": "campaign--linux-run-0001", "target_ref": "attack-pattern--t1083" },

    /* Report → Intrusion set */
    { "type": "relationship", "id": "relationship--rep-owns", "relationship_type": "attributed-to", "source_ref": "report--atomic-lab-0001", "target_ref": "intrusion-set--atomic-sim-0001" }
  ]
}
